
t=(0:1:7200); %seconds
N=6.02*10^23*10^-6; %Avogadro constant multiplied with 10^-6 for cm^3 to m^3
kf=[1.1*10^-8 2.2*10^9 1.5*10^11 N*2.2*10^-21 N*3.2*10^-22 N*10^-23 N*9.4*10^-27 N*2.3*10^-23 N*3.1*10^-21 N*6.9*10^-13 N*9.9*10^-24 9.5*10^9 8.7*10^10 6.8*10^3 8.4*10^5 7.1*10^3 5*10^9 5.8*10^8 4.4*10^-1 1.4*10^8 2.4*10^1 4.7*10^6 N*1.9*10^-10 N*2.8*10^-10];
kb=[N*4.1*10^-10 N*1.5*10^-9  N*4.4*10^-9 N*1.9*10^-10 4.1*10^9 N*1.9*10^-12 N*6.6*10^-11 3.9*10^2 4.7*10^4 N*5.7*10^-15 N*3.8*10^-19 N*3.3*10^-9 N*7.3*10^-9 N*3*10^-9  N*2.3*10^-10 N*1.4*10^-9 N*1.5*10^-9 N*3.1*10^-9 N*3.7*10^-12 N*5.1*10^-10 N*5*10^-10 N*3.9*10^-11 1.8*10^-10 2.7*10^-4];
keq=kf./kb;
kfn=1.1*kf; % 10 percent increment in kf to study drc
kbn=kfn./keq; % new kb to keep keq constant
pch4=0.45*101325; %pressure of methane in pascal
v0=1*10^-3; %m^3, initial volume
nch4=pch4*v0/(8.314*973); %initial moles of methane
par=0.45*101325;%pressure of argon in pascal
nar=par*v0/(8.314*973);%initial moles of argon
pna=0.1*101325;%pressure of sodium in pascal
nna=pna*v0/(8.314*973);%initial moles of sodium
ni=nch4+nar+nna; %total initial moles
j=[nch4 0 0 0 nna 0 0 0 0 0 0 0 0 0 0 0];
[t,n]=ode15s(@cca,t,j);

nt=n(:,1)+n(:,2)+n(:,3)+n(:,4)+n(:,5)+n(:,6)+n(:,7)+n(:,8)+n(:,9)+n(:,10)+n(:,11)+n(:,12)+n(:,13)+n(:,14)+n(:,15)+n(:,16)+nar;
% nt is total moles present at any time t.
vt=nt.*(v0/ni); % total volume at any time t since pressure is constant


r1=vt.*((-kf(1).*(n(:,1)./vt) + kb(1).*(n(:,2)./vt).*(n(:,3)./vt)) + (-kf(4).*(n(:,1)./vt).*(n(:,5)./vt) + kb(4).*(n(:,7)./vt).*(n(:,2)./vt))  + (-kf(5).*(n(:,1)./vt).*(n(:,5)./vt) + kb(5).*(n(:,8)./vt)) + (-kf(6).*(n(:,1)./vt).*(n(:,4)./vt) + kb(6).*(n(:,9)./vt).*(n(:,2)./vt)) + (-kf(7).*(n(:,1)./vt).*(n(:,4)./vt) + kb(7).*(n(:,10)./vt).*(n(:,3)./vt)) + (-kf(8).*(n(:,1)./vt).*(n(:,4)./vt) + kb(8).*(n(:,11)./vt)) + (-kf(9).*(n(:,1)./vt).*(n(:,6)./vt) + kb(9).*(n(:,12)./vt)) + (-kf(10).*(n(:,1)./vt).*(n(:,3)./vt) + kb(10).*(n(:,2)./vt).*(n(:,13)./vt)) + (-kf(11).*(n(:,1)./vt).*(n(:,2)./vt) + kb(11).*(n(:,14)./vt).*(n(:,3)./vt)));

r2= vt.*((kf(1).*(n(:,1)./vt) + -kb(1).*(n(:,2)./vt).*(n(:,3)./vt)) + (kf(4).*(n(:,1)./vt).*(n(:,5)./vt) + -kb(4).*(n(:,2)./vt).*(n(:,7)./vt)) + (kf(6).*(n(:,1)./vt).*(n(:,4)./vt) + -kb(6).*(n(:,2)./vt).*(n(:,9)./vt))+ (kf(10).*(n(:,1)./vt).*(n(:,3)./vt) + -kb(10).*(n(:,2)./vt).*(n(:,13)./vt))+ (-kf(11).*(n(:,1)./vt).*(n(:,2)./vt) + kb(11).*(n(:,14)./vt).*(n(:,3)./vt))+ (kf(13).*(n(:,8)./vt) + -kb(13).*(n(:,2)./vt).*(n(:,7)./vt))+ (kf(15).*(n(:,15)./vt) + -kb(15).*(n(:,2)./vt).*(n(:,5)./vt))+ (kf(18).*(n(:,10)./vt) + -kb(18).*(n(:,2)./vt).*(n(:,4)./vt))+ 2.*(-kf(24).*(n(:,2)./vt).*(n(:,2)./vt) + kb(24).*(n(:,14)./vt)));

r3= vt.*((kf(1).*(n(:,1)./vt) + -kb(1).*(n(:,2)./vt).*(n(:,3)./vt))+ (kf(7).*(n(:,1)./vt).*(n(:,4)./vt) + -kb(7).*(n(:,3)./vt).*(n(:,10)./vt))+ (-kf(10).*(n(:,3)./vt).*(n(:,1)./vt) + kb(10).*(n(:,2)./vt).*(n(:,13)./vt))+ (kf(11).*(n(:,1)./vt).*(n(:,2)./vt) + -kb(11).*(n(:,3)./vt).*(n(:,14)./vt))+ (kf(12).*(n(:,8)./vt) + -kb(12).*(n(:,3)./vt).*(n(:,15)./vt))+ (kf(14).*(n(:,7)./vt) + -kb(14).*(n(:,3)./vt).*(n(:,5)./vt))+ (kf(16).*(n(:,9)./vt) + -kb(16).*(n(:,3)./vt).*(n(:,4)./vt))+ (kf(21).*(n(:,16)./vt) + -kb(21).*(n(:,3)./vt).*(n(:,6)./vt))+ 2.*(-kf(23).*(n(:,3)./vt).*(n(:,3)./vt) + kb(23).*(n(:,13)./vt)));

r4= vt.*((-kf(2).*(n(:,4)./vt) + kb(2).*(n(:,5)./vt).*(n(:,5)./vt))+ (kf(3).*(n(:,6)./vt) + -kb(3).*(n(:,4)./vt).*(n(:,5)./vt))+ (-kf(6).*(n(:,1)./vt).*(n(:,4)./vt) + kb(6).*(n(:,9)./vt).*(n(:,2)./vt))+ (-kf(7).*(n(:,1)./vt).*(n(:,4)./vt) + kb(7).*(n(:,10)./vt).*(n(:,3)./vt))+ (-kf(8).*(n(:,1)./vt).*(n(:,4)./vt) + kb(8).*(n(:,11)./vt))+ (kf(16).*(n(:,9)./vt) + -kb(16).*(n(:,4)./vt).*(n(:,3)./vt))+ (kf(18).*(n(:,10)./vt) + -kb(18).*(n(:,4)./vt).*(n(:,2)./vt))+ (kf(20).*(n(:,16)./vt) + -kb(20).*(n(:,4)./vt).*(n(:,7)./vt)));

r5= vt.*(2.*(kf(2).*(n(:,4)./vt) + -kb(2).*(n(:,5)./vt).*(n(:,5)./vt))+ (kf(3).*(n(:,6)./vt) + -kb(3).*(n(:,4)./vt).*(n(:,5)./vt))+ (-kf(4).*(n(:,5)./vt).*(n(:,1)./vt) + kb(4).*(n(:,2)./vt).*(n(:,7)./vt))+ (-kf(5).*(n(:,5)./vt).*(n(:,1)./vt) + kb(5).*(n(:,8)./vt))+ (kf(14).*(n(:,7)./vt) + -kb(14).*(n(:,5)./vt).*(n(:,3)./vt))+ (kf(15).*(n(:,15)./vt) + -kb(15).*(n(:,5)./vt).*(n(:,2)./vt))+ (kf(17).*(n(:,9)./vt) + -kb(17).*(n(:,5)./vt).*(n(:,7)./vt))+ (kf(19).*(n(:,10)./vt) + -kb(19).*(n(:,5)./vt).*(n(:,15)./vt))+ (kf(22).*(n(:,16)./vt) + -kb(22).*(n(:,5)./vt).*(n(:,9)./vt)));

r6= vt.*((-kf(3).*(n(:,6)./vt) + kb(3).*(n(:,4)./vt).*(n(:,5)./vt))+ (-kf(9).*(n(:,6)./vt).*(n(:,1)./vt) + kb(9).*(n(:,12)./vt))+ (kf(21).*(n(:,16)./vt) + -kb(21).*(n(:,6)./vt).*(n(:,3)./vt)));

r7= vt.*((kf(4).*(n(:,1)./vt).*(n(:,5)./vt) + -kb(4).*(n(:,2)./vt).*(n(:,7)./vt))+ (kf(13).*(n(:,8)./vt) + -kb(13).*(n(:,2)./vt).*(n(:,7)./vt))+ (-kf(14).*(n(:,7)./vt) + kb(14).*(n(:,3)./vt).*(n(:,5)./vt))+ (kf(17).*(n(:,9)./vt) + -kb(17).*(n(:,5)./vt).*(n(:,7)./vt))+ (kf(20).*(n(:,16)./vt) + -kb(20).*(n(:,4)./vt).*(n(:,7)./vt)));

r8= vt.*((kf(5).*(n(:,5)./vt).*(n(:,1)./vt) + -kb(5).*(n(:,8)./vt))+ (-kf(12).*(n(:,8)./vt) + kb(12).*(n(:,15)./vt).*(n(:,3)./vt))+ (-kf(13).*(n(:,8)./vt) + kb(13).*(n(:,2)./vt).*(n(:,7)./vt)));

r9= vt.*((kf(6).*(n(:,4)./vt).*(n(:,1)./vt) + -kb(6).*(n(:,9)./vt).*(n(:,2)./vt))+ (-kf(16).*(n(:,9)./vt) + kb(16).*(n(:,4)./vt).*(n(:,3)./vt))+ (-kf(17).*(n(:,9)./vt) + kb(17).*(n(:,5)./vt).*(n(:,7)./vt))+ (kf(22).*(n(:,16)./vt) + -kb(22).*(n(:,9)./vt).*(n(:,5)./vt)));

r10=  vt.*((kf(7).*(n(:,1)./vt).*(n(:,4)./vt) + -kb(7).*(n(:,10)./vt).*(n(:,3)./vt))+ (-kf(18).*(n(:,10)./vt) + kb(18).*(n(:,2)./vt).*(n(:,4)./vt))+ (-kf(19).*(n(:,10)./vt) + kb(19).*(n(:,5)./vt).*(n(:,15)./vt)));

r11=  vt.*((kf(8).*(n(:,1)./vt).*(n(:,4)./vt) + -kb(8).*(n(:,11)./vt)));

r12= vt.*((kf(9).*(n(:,1)./vt).*(n(:,6)./vt) + -kb(9).*(n(:,12)./vt)));

r13= vt.*((kf(10).*(n(:,1)./vt).*(n(:,3)./vt) + -kb(10).*(n(:,2)./vt).*(n(:,13)./vt))+ (kf(23).*(n(:,3)./vt).*(n(:,3)./vt) + -kb(23).*(n(:,13)./vt)));

r14=  vt.*((kf(11).*(n(:,1)./vt).*(n(:,2)./vt) + -kb(11).*(n(:,14)./vt).*(n(:,3)./vt))+ (kf(24).*(n(:,2)./vt).*(n(:,2)./vt) + -kb(24).*(n(:,14)./vt)));

r15=  vt.*((kf(12).*(n(:,8)./vt) + -kb(12).*(n(:,15)./vt).*(n(:,3)./vt))+ (-kf(15).*(n(:,15)./vt) + kb(15).*(n(:,2)./vt).*(n(:,5)./vt))+ (kf(19).*(n(:,10)./vt) + -kb(19).*(n(:,5)./vt).*(n(:,15)./vt)));

r16=  vt.*((-kf(20).*(n(:,16)./vt) + kb(20).*(n(:,4)./vt).*(n(:,7)./vt))+ (-kf(21).*(n(:,16)./vt) + kb(21).*(n(:,6)./vt).*(n(:,3)./vt))+ (-kf(22).*(n(:,16)./vt) + kb(22).*(n(:,9)./vt).*(n(:,5)./vt)));


%drc code



x1= (-kfn(1).*(n(:,1)./vt) + kbn(1).*(n(:,2)./vt).*(n(:,3)./vt)).*(vt./r1);
x2=0;
x3=0;
x4=(-kfn(4).*(n(:,1)./vt).*(n(:,5)./vt) + kbn(4).*(n(:,7)./vt).*(n(:,2)./vt)).*(vt./r1);
x5=(-kfn(5).*(n(:,1)./vt).*(n(:,5)./vt) + kbn(5).*(n(:,8)./vt)).*(vt./r1);
x6=(-kfn(6).*(n(:,1)./vt).*(n(:,4)./vt) + kbn(6).*(n(:,9)./vt).*(n(:,2)./vt)).*(vt./r1);
x7=(-kfn(7).*(n(:,1)./vt).*(n(:,4)./vt) + kbn(7).*(n(:,10)./vt).*(n(:,3)./vt)).*(vt./r1);
x8=(-kfn(8).*(n(:,1)./vt).*(n(:,4)./vt) + kbn(8).*(n(:,11)./vt)).*(vt./r1);
x9=(-kfn(9).*(n(:,1)./vt).*(n(:,6)./vt) + kbn(9).*(n(:,12)./vt)).*(vt./r1);
x10=(-kfn(10).*(n(:,1)./vt).*(n(:,3)./vt) + kbn(10).*(n(:,2)./vt).*(n(:,13)./vt)).*(vt./r1);
x11=(-kfn(11).*(n(:,1)./vt).*(n(:,2)./vt) + kbn(11).*(n(:,14)./vt).*(n(:,3)./vt)).*(vt./r1);
x12=0;
x13=0;
x14=0;
x15=0;
x16=0;
x17=0;
x18=0;
x19=0;
x20=0;
x21=0;
x22=0;
x23=0;
x24=0;
h=x1+x2+x3+x4+x5+x6+x7+x8+x9+x10+x11+x12+x13+x14+x15+x16+x17+x18+x19+x20+x21+x22+x23+x24

figure
plot(t,n(:,1))
xlabel('Time in seconds')
ylabel('Mole of CH4')
title('Variation in Mole of CH4 wrt Time')
figure
t1=[0:1:14];
plot(t1,x1(1:15))
hold on
plot(t1,zeros([1 15])) %x2
plot(t1,zeros([1 15])) %x3
plot(t1,x4(1:15),'blue')
plot(t1,x5(1:15),'green')
plot(t1,x6(1:15))
plot(t1,x7(1:15))
plot(t1,x8(1:15))
plot(t1,x9(1:15))
plot(t1,x10(1:15),'red')
plot(t1,x11(1:15))
plot(t1,zeros([1 15]))%x12
plot(t1,zeros([1 15]))%x13
plot(t1,zeros([1 15]))%x14
plot(t1,zeros([1 15]))%x15
plot(t1,zeros([1 15]))%x16
plot(t1,zeros([1 15]))%x17
plot(t1,zeros([1 15]))%x18
plot(t1,zeros([1 15]))%x19
plot(t1,zeros([1 15]))%x20
plot(t1,zeros([1 15]))%x21
plot(t1,zeros([1 15]))%x22
plot(t1,zeros([1 15]))%x23
plot(t1,zeros([1 15]))%x24
xlabel('Time in seconds')
ylabel('X(DRC)')
legend('rxn1','rxn2','rxn3','rxn4','rxn5','rxn6','rxn7','rxn8','rxn9','rxn10','rxn11','rxn12','rxn13','rxn14','rxn15','rxn16','rxn17','rxn18','rxn19','rxn20','rxn21','rxn22','rxn23','rxn24')
title('Sensitivity Analysis based on Degree of Rate Control')


